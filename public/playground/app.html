<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Esor Playground</title>
  <script src="https://unpkg.com/@stackblitz/sdk@1/bundles/sdk.umd.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #1e1e1e;
      color: #fff;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background: #2d2d30;
      padding: 12px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid #3e3e42;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo h1 {
      font-size: 20px;
      font-weight: 600;
    }

    .logo a {
      color: #4ec9b0;
      text-decoration: none;
      font-size: 14px;
    }

    .tabs {
      display: flex;
      gap: 8px;
      padding: 0 20px;
      background: #252526;
      border-bottom: 1px solid #3e3e42;
    }

    .tab {
      padding: 10px 16px;
      background: none;
      border: none;
      color: #969696;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      font-size: 14px;
    }

    .tab:hover {
      color: #fff;
    }

    .tab.active {
      color: #fff;
      border-bottom-color: #4ec9b0;
    }

    #playground-container {
      flex: 1;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <h1>‚ö° Esor Playground</h1>
      <a href="/doc/">‚Üê Back to Docs</a>
    </div>
  </header>

  <div class="tabs">
    <button class="tab active" data-example="counter">Counter</button>
    <button class="tab" data-example="todo">Todo List</button>
    <button class="tab" data-example="user-card">User Card</button>
    <button class="tab" data-example="fetch">Data Fetching</button>
  </div>

  <div id="playground-container"></div>

  <script>
    const examples = {
      counter: {
        files: {
          'index.html': \`<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Counter</title></head>
<body>
<counter-app></counter-app>
<script type="module" src="./app.js"></script>
</body></html>\`,
          'app.js': \`import{component,html,signal}from"https://unpkg.com/esor@latest/dist/esor.js";component("counter-app",()=>{const c=signal(0);return html\\\`<style>:host{display:block;font-family:system-ui;padding:20px;text-align:center}h1{color:#e74c3c;font-size:3rem;margin:0}.buttons{display:flex;gap:10px;justify-content:center;margin-top:20px}button{background:#3498db;border:none;border-radius:4px;color:white;cursor:pointer;font-size:1.2rem;padding:10px 20px}button:hover{background:#2980b9}.reset{background:#95a5a6}</style><div><h1>\\\${c()}</h1><div class="buttons"><button @click=\\\${()=>c(c()-1)}>-</button><button @click=\\\${()=>c(0)} class="reset">Reset</button><button @click=\\\${()=>c(c()+1)}>+</button></div></div>\\\`})\`
        }
      },
      todo: {
        files: {
          'index.html': \`<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Todo</title></head>
<body>
<todo-app></todo-app>
<script type="module" src="./app.js"></script>
</body></html>\`,
          'app.js': \`import{component,html,signal}from"https://unpkg.com/esor@latest/dist/esor.js";component("todo-app",()=>{const t=signal([{id:1,text:"Learn Esor",done:!1},{id:2,text:"Build something",done:!1}]),i=signal("");const add=()=>{if(i().trim()){t([...t(),{id:Date.now(),text:i(),done:!1}]);i("")}};return html\\\`<style>:host{display:block;max-width:500px;margin:20px auto;padding:20px;font-family:system-ui}h1{text-align:center;color:#2c3e50}input,button{padding:10px;font-size:16px}button{background:#3498db;color:white;border:none;border-radius:4px;cursor:pointer}</style><div><h1>üìù Tasks</h1><div style="display:flex;gap:8px;margin:20px 0"><input type="text" placeholder="Add task..." :value=\\\${i()} @input=\\\${e=>i(e.target.value)} @keypress=\\\${e=>e.key==='Enter'&&add()} style="flex:1"><button @click=\\\${add}>Add</button></div><ul style="list-style:none;padding:0">\\\${t().map(todo=>html\\\`<li key=\\\${todo.id} style="padding:12px;background:#f8f9fa;margin-bottom:8px;border-radius:4px"><span>\\\${todo.text}</span></li>\\\`)}</ul></div>\\\`})\`
        }
      },
      'user-card': {
        files: {
          'index.html': \`<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>User Card</title></head>
<body>
<user-card name="Alice" role="Developer" avatar="üë©‚Äçüíª"></user-card>
<script type="module" src="./app.js"></script>
</body></html>\`,
          'app.js': \`import{component,html}from"https://unpkg.com/esor@latest/dist/esor.js";component("user-card",({name,role,avatar})=>html\\\`<style>:host{display:block;max-width:300px;margin:20px}.card{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-radius:12px;padding:30px;color:white;text-align:center}.avatar{font-size:4rem;margin-bottom:15px}h2{margin:0 0 5px 0;font-size:1.5rem}p{margin:0;opacity:0.9}</style><div class="card"><div class="avatar">\\\${avatar}</div><h2>\\\${name}</h2><p>\\\${role}</p></div>\\\`)\`
        }
      },
      fetch: {
        files: {
          'index.html': \`<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Fetch</title></head>
<body>
<random-user></random-user>
<script type="module" src="./app.js"></script>
</body></html>\`,
          'app.js': \`import{component,html,signal,effect}from"https://unpkg.com/esor@latest/dist/esor.js";component("random-user",()=>{const u=signal(null),l=signal(!1);const f=async()=>{l(!0);try{const r=await fetch('https://randomuser.me/api/'),d=await r.json();u(d.results[0])}catch(e){console.error(e)}finally{l(!1)}};effect(()=>f());return html\\\`<style>:host{display:block;max-width:400px;margin:20px auto;font-family:system-ui;text-align:center}h2{color:#2c3e50}img{width:120px;border-radius:50%}button{background:#3498db;color:white;border:none;padding:12px 24px;border-radius:6px;cursor:pointer;margin-top:15px}</style><div><h2>üé≤ Random User</h2>\\\${l()?html\\\`<p>Loading...</p>\\\`:u()?html\\\`<div><img src="\\\${u().picture.large}"><p><strong>\\\${u().name.first} \\\${u().name.last}</strong></p><p>\\\${u().email}</p><button @click=\\\${f}>Get Another</button></div>\\\`:null}</div>\\\`})\`
        }
      }
    };

    function loadExample(id) {
      StackBlitzSDK.embedProject(
        'playground-container',
        {
          title: 'Esor Example',
          template: 'html',
          files: examples[id].files
        },
        {
          height: '100%',
          openFile: 'index.html',
          view: 'preview',
          theme: 'dark'
        }
      );
    }

    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        loadExample(tab.dataset.example);
      });
    });

    loadExample('counter');
  </script>
</body>
</html>
